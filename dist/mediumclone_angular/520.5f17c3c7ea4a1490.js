"use strict";(self.webpackChunkmediumclone_angular=self.webpackChunkmediumclone_angular||[]).push([[520],{3520:(E,m,r)=>{r.r(m),r.d(m,{routes:()=>y});var u=r(6814),i=r(95),s=r(4221),d=r(4574),p=r(2572),f=r(2181),l=r(5839),h=r(493);const g={isSubmitting:!1,validationErrors:null},b=(0,s.Tz)({name:"settings",reducer:(0,s.Lq)(g,(0,s.on)(l.Y.updateCurrentUser,e=>({...e,isSubmitting:!0})),(0,s.on)(l.Y.updateCurrentUserSuccess,e=>({...e,isSubmitting:!1})),(0,s.on)(l.Y.updateCurrentUserFailure,(e,a)=>({...e,isSubmitting:!1,validationErrors:a.errors})),(0,s.on)(h.hn,()=>g))}),{name:U,reducer:v,selectIsSubmitting:x,selectValidationErrors:S}=b;var Z=r(8904),t=r(5879);function C(e,a){if(1&e&&t._UZ(0,"app-backend-error-messages",17),2&e){const o=t.oxw(2).ngIf;t.Q6J("backendErrors",o.validationErrors)}}function T(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h1",6),t._uU(5,"Settings"),t.qZA(),t.YNc(6,C,1,1,"app-backend-error-messages",7),t.TgZ(7,"form",8),t.NdJ("ngSubmit",function(){t.CHM(o);const c=t.oxw(2);return t.KtG(c.onSubmit())}),t.TgZ(8,"fieldset")(9,"fieldset",9),t._UZ(10,"input",10),t.qZA(),t.TgZ(11,"fieldset",9),t._UZ(12,"input",11),t.qZA(),t.TgZ(13,"fieldset",9),t._UZ(14,"textarea",12),t.qZA(),t.TgZ(15,"fieldset",9),t._UZ(16,"input",13),t.qZA(),t.TgZ(17,"fieldset",9),t._UZ(18,"input",14),t.qZA(),t.TgZ(19,"button",15),t._uU(20," Update settings "),t.qZA()()(),t._UZ(21,"hr"),t.TgZ(22,"button",16),t.NdJ("click",function(){t.CHM(o);const c=t.oxw(2);return t.KtG(c.logout())}),t._uU(23," Or click here to logout "),t.qZA()()()()()}if(2&e){const o=t.oxw().ngIf,n=t.oxw();t.xp6(6),t.Q6J("ngIf",o.validationErrors),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(12),t.Q6J("disabled",n.form.invalid||o.isSubmitting)}}function _(e,a){if(1&e&&(t.ynx(0),t.YNc(1,T,24,3,"div",1),t.BQk()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.currentUser)}}const y=[{path:"",component:(()=>{var e;class a{constructor(n,c){this.fb=n,this.store=c,this.form=this.fb.nonNullable.group({image:"",username:"",bio:"",email:"",password:""}),this.data$=(0,p.a)({isSubmitting:this.store.select(x),validationErrors:this.store.select(S)})}ngOnInit(){this.currentUserSubscription=this.store.pipe((0,s.Ys)(d.HF),(0,f.h)(Boolean)).subscribe(n=>{this.currentUser=n,this.initializeForm()})}initializeForm(){if(!this.currentUser)throw new Error("currentUser is undefined");this.form.patchValue({image:this.currentUser.image??"",username:this.currentUser.username,bio:this.currentUser.bio??"",email:this.currentUser.email,password:""})}onSubmit(){if(!this.currentUser)throw new Error("currentUser is undefined");const n={user:{...this.currentUser,...this.form.getRawValue()}};this.store.dispatch(l.Y.updateCurrentUser({currentUserRequest:n}))}logout(){this.store.dispatch(l.Y.logout())}ngOnDestroy(){this.currentUserSubscription?.unsubscribe()}}return(e=a).\u0275fac=function(n){return new(n||e)(t.Y36(i.qu),t.Y36(s.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-settings"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],["class","settings-page",4,"ngIf"],[1,"settings-page"],[1,"container","page"],[1,"row"],[1,"col-md-6","offset-md-3","col-xs-12"],[1,"text-xs-center"],[3,"backendErrors",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-group"],["type","text","formControlName","image","placeholder","URL of profile picture",1,"form-control","form-control-lg"],["type","text","formControlName","username","placeholder","Username",1,"form-control","form-control-lg"],["type","text","formControlName","bio","placeholder","Short bio about you",1,"form-control","form-control-lg"],["type","text","formControlName","email","placeholder","Email",1,"form-control","form-control-lg"],["type","password","formControlName","password","placeholder","New password",1,"form-control","form-control-lg"],[1,"btn","btn-lg","btn-primary","pull-xs-right",3,"disabled"],[1,"btn","btn-outline-danger",3,"click"],[3,"backendErrors"]],template:function(n,c){1&n&&(t.YNc(0,_,2,1,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,c.data$))},dependencies:[u.ez,u.O5,u.Ov,Z.a,i.UX,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u],encapsulation:2}),a})(),providers:[(0,s.oY)(U,v)]}]}}]);